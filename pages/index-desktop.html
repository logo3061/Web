<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TEK Intra | Staff Network</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/bcryptjs@2.4.3/dist/bcrypt.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
    <style>
        :root { 
            --bg-dark: #000000;
            --accent-blue: rgba(59, 130, 246, 0.3);
            --accent-red: rgba(239, 68, 68, 0.3);
        }
        
        body { background-color: var(--bg-dark); color: #ffffff; font-family: 'Inter', sans-serif; overflow-x: hidden; min-height: 100vh; }

        /* --- THE SIGNATURE AMBIENT GLOW --- */
        .graphic-glow {
            position: fixed; top: 50%; right: -5%; transform: translateY(-50%);
            width: 55vw; height: 80vh; z-index: -1;
            background: 
                radial-gradient(circle at 30% 40%, var(--accent-blue) 0%, transparent 60%),
                radial-gradient(circle at 70% 60%, var(--accent-red) 0%, transparent 60%);
            filter: blur(100px); opacity: 0.6; pointer-events: none;
        }

        .sirius-card { 
            background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.05); transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .sirius-card:hover { border-color: rgba(255, 255, 255, 0.15); transform: translateY(-4px); background: rgba(255, 255, 255, 0.04); }

        .reveal { opacity: 0; transform: translateY(25px); transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        .reveal.visible { opacity: 1; transform: translateY(0); }

        .nav-link { font-size: 0.7rem; color: #52525b; font-weight: 700; transition: all 0.3s; text-transform: uppercase; letter-spacing: 0.2em; }
        .nav-link:hover, .nav-link.active { color: #ffffff; }

        .sirius-button { background: #fff; color: #000; font-weight: 800; text-transform: uppercase; transition: all 0.2s; cursor: pointer; }
        .sirius-button:disabled { background: #1a1a1a !important; color: #3f3f46 !important; cursor: not-allowed; border: 1px solid #27272a; }

        .page-view { display: none; }
        .active-view { display: block; }
        
        #modal-overlay.hidden { display: none; }
        #modal-overlay.active { display: flex; animation: fadeIn 0.3s forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        ::-webkit-scrollbar { width: 0px; }
    </style>
</head>
<body>
    <div class="graphic-glow"></div>

    <div id="login-overlay" class="fixed inset-0 z-[9999] flex bg-black transition-opacity duration-1000">
        <div class="w-full lg:w-[450px] h-full flex flex-col justify-center px-12 sm:px-20 bg-gradient-to-r from-black via-black/80 to-transparent backdrop-blur-3xl border-r border-white/5 relative z-10">
            <div class="reveal visible">
                
                <div class="space-y-8">
                    <div>
                        <h1 class="text-3xl font-black tracking-tighter mb-2">Internal Access</h1>
                        <p class="text-[10px] font-mono text-zinc-500 uppercase tracking-[0.3em]">Authorized Personnel Only</p>
                    </div>

                    <div class="space-y-4">
                        <div class="group">
                            <label class="text-[9px] font-bold text-zinc-600 uppercase tracking-widest ml-1 mb-2 block group-focus-within:text-blue-500 transition-colors">Staff Identifier</label>
                            <input type="text" id="user-input" placeholder="STAFF_ID" 
                                class="w-full bg-white/[0.03] border border-white/10 rounded-xl p-4 text-xs font-mono tracking-widest focus:outline-none focus:border-blue-500/50 focus:bg-white/[0.05] transition-all text-white">
                        </div>
                        
                        <div class="group">
                            <label class="text-[9px] font-bold text-zinc-600 uppercase tracking-widest ml-1 mb-2 block group-focus-within:text-blue-500 transition-colors">Security Key</label>
                            <input type="password" id="pass-input" placeholder="••••••••" 
                                class="w-full bg-white/[0.03] border border-white/10 rounded-xl p-4 text-xs font-mono tracking-widest focus:outline-none focus:border-blue-500/50 focus:bg-white/[0.05] transition-all text-white">
                        </div>

                        <button onclick="validateLogin()" 
                            class="w-full py-4 mt-4 bg-white text-black rounded-xl text-[10px] font-black uppercase tracking-[0.2em] hover:bg-blue-500 hover:text-white transition-all duration-300 transform active:scale-[0.98]">
                            Login
                        </button>
                    </div>

                    <p id="login-err" class="text-red-500 text-[9px] mt-6 uppercase tracking-[0.3em] font-bold opacity-0 transition-opacity">
                        Access Denied: Invalid Credentials
                    </p>
                </div>

                <div class="absolute bottom-12 left-12 sm:left-20">
                    <p class="text-[8px] text-zinc-700 font-mono tracking-widest uppercase">Encryption: AES-256 Bit</p>
                </div>
            </div>
        </div>

        <div class="hidden lg:flex flex-1 items-center justify-center relative overflow-hidden">
            <div class="relative z-10 text-right pr-20 select-none pointer-events-none">
                <h2 class="text-[180px] leading-[0.8] font-black tracking-[0.05em] opacity-30">TEK INTRA</h2>
                <p class="text-m font-mono text-zinc-500 tracking-[1em] uppercase mt-4 mr-4">The nexus of TEK</p>
            </div>
            <div class="absolute inset-0 bg-gradient-to-br from-blue-600/15 via-transparent to-red-600/20"></div>
        </div>
    </div>

    <div id="main-content" class="hidden opacity-0 transition-opacity duration-1000">
        <nav class="fixed top-0 w-full z-50 flex items-center justify-between px-12 py-10 bg-gradient-to-b from-black to-transparent">
            <div class="flex items-center gap-4">
                <img src="assets/logo.png" alt="Logo" class="h-6 opacity-90">
                <span class="text-sm font-black tracking-tighter text-zinc-400">TEK INTRA</span>
            </div>
            <div class="flex items-center gap-12">
                <button onclick="showPage('home')" id="nav-home" class="nav-link active">Home</button>
                <button onclick="showPage('projects')" id="nav-projects" class="nav-link">Projects</button>
                <button onclick="showPage('downloads')" id="nav-downloads" class="nav-link">Ressources</button>
                <button onclick="logout()" class="text-[9px] font-bold text-red-900/60 hover:text-red-500 uppercase tracking-widest transition-colors">Log out</button>
            </div>
        </nav>

        <main id="page-home" class="page-view active-view pt-64 px-12 max-w-7xl mx-auto pb-20">
    <div class="flex flex-col lg:flex-row gap-24 items-start mb-32">
        <div class="lg:w-5/12 reveal">
            <h1 class="text-[120px] leading-[0.8] font-black tracking-tighter mb-6">TEK<br><span class="text-zinc-800">Intra</span></h1>
            <p class="text-xl text-zinc-500 mb-10 font-light">The ultimate all-in-one staff nexus.</p>
        </div>
        <div class="lg:w-7/12">
            <p class="text-[10px] font-bold mb-10 tracking-[0.3em] text-zinc-600 uppercase">About TEK INTRA</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div class="sirius-card p-8 rounded-[35px] reveal">
                    <h4 class="font-bold text-sm mb-3">All-in-one</h4>
                    <p class="text-[11px] text-zinc-500">TEK INTRA centralizes everything you need in one place.</p>
                </div>
                <div class="sirius-card p-8 rounded-[35px] reveal">
                    <h4 class="font-bold text-sm mb-3">Downloads</h4>
                    <p class="text-[11px] text-zinc-500">Access all essential development assets for TEK Studios.</p>
                </div>
                <div class="sirius-card p-8 rounded-[35px] reveal">
                    <h4 class="font-bold text-sm mb-3">Overview</h4>
                    <p class="text-[11px] text-zinc-500">Get a comprehensive high-level view of TEK Studios' operations.</p>
                </div>
                <div class="sirius-card p-8 rounded-[35px] reveal">
                    <h4 class="font-bold text-sm mb-3">Precision Design</h4>
                    <p class="text-[11px] text-zinc-500">Tailored specifically to optimize the TEK Studios development workflow.</p>
                </div>
            </div>
        </div>
    </div>
    
    <h3 class="text-[10px] font-bold mb-10 tracking-[0.3em] text-zinc-600 uppercase reveal">Latest news</h3>
    <div id="news-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
</main>

<main id="page-projects" class="page-view pt-64 px-12 max-w-7xl mx-auto pb-20">
    <h2 class="text-6xl font-black tracking-tighter mb-4 reveal">Projects</h2>
    <p class="text-zinc-500 mb-16 reveal">A complete overview of our current and past works.</p>
    <div id="game-grid" class="grid grid-cols-1 md:grid-cols-4 gap-6"></div>
</main>

<main id="page-downloads" class="page-view pt-64 px-12 max-w-7xl mx-auto pb-20">
    <h2 class="text-6xl font-black tracking-tighter mb-4 reveal">Resources</h2>
    <p class="text-zinc-500 mb-16 reveal">Centralized repository for secure assets and software builds.</p>
    <div id="downloads-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
</main>

    <div id="modal-overlay" class="fixed inset-0 z-[10000] hidden bg-black/95 backdrop-blur-xl flex items-center justify-center p-6">
        <div id="modal-content" class="sirius-card max-w-2xl w-full rounded-[50px] overflow-hidden transition-all duration-500 transform scale-95 border-white/10">
            <div class="h-64 bg-zinc-900 relative">
                <img id="m-image" src="" class="w-full h-full object-cover">
                
                <div id="m-status-badge" class="absolute bottom-6 left-8 flex items-center gap-3 bg-black/60 backdrop-blur-md px-4 py-2 rounded-full border border-white/10">
                    <div id="m-status-dot" class="w-2.5 h-2.5 rounded-full"></div>
                    <span id="m-status-text" class="text-[10px] font-black uppercase tracking-[0.2em]"></span>
                </div>

                <button onclick="closeModal()" class="absolute top-8 right-8 bg-black/50 p-2 rounded-full hover:bg-white hover:text-black transition-all">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="p-16 text-center">
                <h2 id="m-title" class="text-4xl font-black tracking-tighter mb-4"></h2>
                <p id="m-desc" class="text-zinc-500 text-xs leading-relaxed mb-10"></p>
                <button id="m-btn" class="sirius-button w-full py-5 rounded-2xl text-[10px] tracking-[0.2em] shadow-xl"></button>
            </div>
        </div>
    </div>

    <script>
        const bcrypt = dcodeIO.bcrypt;
        let cachedGames = [];

        // 10-Point Status Map
        const statusMap = {
            "operational":  { color: "#10b981", label: "Operational" },
            "active":       { color: "#10b981", label: "Active" },
            "paused":       { color: "#64748b", label: "Paused" },
            "standby":      { color: "#64748b", label: "Standby" },
            "maintenance":  { color: "#f59e0b", label: "Maintenance" },
            "updating":     { color: "#f59e0b", label: "Updating" },
            "testing":      { color: "#0ea5e9", label: "Testing" },
            "beta":         { color: "#0ea5e9", label: "Beta" },
            "patched":      { color: "#6366f1", label: "Patched" },
            "disabled":     { color: "#ef4444", label: "Disabled" },
            "terminated":   { color: "#ef4444", label: "Terminated" },
            "review":       { color: "#a855f7", label: "Under Review" },
            "secure":       { color: "#14b8a6", label: "Secure" },
            "experimental": { color: "#f43f5e", label: "Experimental" },
            "offline":      { color: "#27272a", label: "Offline" }
        };

        // --- AUTH ---
        async function validateLogin() {
            const u = document.getElementById('user-input').value;
            const p = document.getElementById('pass-input').value;
            try {
                const res = await fetch('/db.json');
                const data = await res.json();
                const user = data.users.find(usr => usr.username.toLowerCase() === u.toLowerCase());
                if (user && bcrypt.compareSync(p, user.password)) {
                    Cookies.set('tek_session', user.username, { expires: 7 });
                    revealUI();
                } else {
                    document.getElementById('login-err').style.opacity = '1';
                }
            } catch (e) { revealUI(); } // Bypass for local environment
        }

        function revealUI() {
            document.getElementById('login-overlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('login-overlay').style.display = 'none';
                const main = document.getElementById('main-content');
                main.classList.remove('hidden');
                setTimeout(() => main.style.opacity = '1', 50);
                loadAllData();
            }, 700);
        }

        function logout() { Cookies.remove('tek_session'); location.reload(); }

        // --- DATA ---
        async function loadAllData() {
            try {
                const [nRes, gRes, dRes] = await Promise.all([
                    fetch('data/news.json'), fetch('data/games.json'), fetch('data/downloads.json')
                ]);
                
                const news = await nRes.json();
                cachedGames = await gRes.json();
                const downloads = await dRes.json();

                // Announcements
                document.getElementById('news-grid').innerHTML = news.map(n => `
                    <div class="sirius-card p-10 rounded-[35px] reveal">
                        <span class="text-[9px] font-mono text-zinc-500 uppercase tracking-widest">${n.date || 'Staff Update'}</span>
                        <h4 class="font-bold text-lg mt-3 mb-4 tracking-tight">${n.title}</h4>
                        <p class="text-[11px] text-zinc-500 leading-relaxed">${n.desc}</p>
                    </div>`).join('');

                // Modules
                document.getElementById('game-grid').innerHTML = cachedGames.map((g, i) => {
                    const status = (g.status || "offline").toLowerCase();
                    const config = statusMap[status] || statusMap["offline"];
                    return `
                    <div onclick="openModal(${i})" class="sirius-card p-6 rounded-[30px] cursor-pointer group reveal">
                        <div class="h-44 bg-zinc-900 rounded-[22px] overflow-hidden mb-6">
                            <img src="${g.imageurl}" class="w-full h-full object-cover grayscale opacity-50 group-hover:grayscale-0 group-hover:opacity-100 transition-all duration-700">
                        </div>
                        <h4 class="font-bold text-sm px-2 mb-1">${g.title}</h4>
                        <div class="flex items-center gap-2 px-2 mt-2">
                            <div class="w-1.5 h-1.5 rounded-full" style="background-color: ${config.color}"></div>
                            <span class="text-[9px] font-bold uppercase tracking-widest" style="color: ${config.color}">${config.label}</span>
                        </div>
                    </div>`;
                }).join('');

                // Vault
                document.getElementById('downloads-grid').innerHTML = downloads.map(d => `
                    <div class="sirius-card p-6 rounded-[25px] flex items-center justify-between reveal">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-zinc-600">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="2" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1M7 10l5 5m0 0l5-5m-5 5V3"/></svg>
                            </div>
                            <div>
                                <h4 class="font-bold text-xs text-zinc-300">${d.name}</h4>
                                <p class="text-[9px] text-zinc-600 font-mono mt-0.5">${d.version || 'v1.0'}</p>
                            </div>
                        </div>
                        <a href="${d.url}" download class="bg-white text-black text-[9px] font-black px-5 py-2.5 rounded-xl hover:bg-zinc-200 transition-all uppercase">Download</a>
                    </div>`).join('');

                triggerAnimations();
            } catch (e) { console.error(e); }
        }

        function triggerAnimations() {
            const active = document.querySelector('.active-view');
            active.querySelectorAll('.reveal').forEach((el, i) => {
                setTimeout(() => el.classList.add('visible'), i * 80);
            });
        }

        function showPage(id) {
            document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active-view'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById('page-' + id).classList.add('active-view');
            document.getElementById('nav-' + id).classList.add('active');
            window.scrollTo({top: 0, behavior: 'smooth'});
            triggerAnimations();
        }

        // --- MODAL ENGINE ---
        function openModal(i) {
            const g = cachedGames[i];
            const rawStatus = (g.status || "offline").toLowerCase();
            const config = statusMap[rawStatus] || statusMap["offline"];
            const isOff = g.link === "Inactive" || g.link === "Disabled" || rawStatus === "disabled" || rawStatus === "terminated";
            
            document.getElementById('m-image').src = g.imageurl;
            document.getElementById('m-title').innerText = g.title;
            document.getElementById('m-desc').innerText = g.description || g.excerpt || "Operational data restricted.";
            
            const dot = document.getElementById('m-status-dot');
            const text = document.getElementById('m-status-text');
            dot.style.backgroundColor = config.color;
            dot.style.boxShadow = `0 0 12px ${config.color}`;
            text.innerText = config.label;
            text.style.color = config.color;

            const btn = document.getElementById('m-btn');
            btn.disabled = isOff;
            btn.innerText = isOff ? "Access Restricted" : "Initialize Link";
            btn.onclick = isOff ? null : () => window.open(g.link, '_blank');

            const overlay = document.getElementById('modal-overlay');
            overlay.classList.remove('hidden');
            overlay.classList.add('active');
            setTimeout(() => document.getElementById('modal-content').classList.remove('scale-95'), 10);
        }

        function closeModal() {
            const overlay = document.getElementById('modal-overlay');
            document.getElementById('modal-content').classList.add('scale-95');
            setTimeout(() => {
                overlay.classList.remove('active');
                overlay.classList.add('hidden');
            }, 300);
        }

        window.onload = () => { if(Cookies.get('tek_session')) revealUI(); };
    </script>
</body>
</html>